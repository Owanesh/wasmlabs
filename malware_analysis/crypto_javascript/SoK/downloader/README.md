# MalwareBazaar downloader

This folder contains a small Python script, `sok_downloader.py`, that automates
downloading JavaScript samples referenced in the SoK (Systematization of Knowledge)
CSV dataset `VT_miners.csv` by querying MalwareBazaar (bazaar.abuse.ch).

Rough idea
----------
- Read SHA256 hashes from the `VT_miners.csv` file (the SoK dataset). The CSV is
  expected to contain a header and the second column to be the SHA256 hash used
  by the script.
- For each SHA256 hash, query the MalwareBazaar API for file info. If the API
  indicates the file is a JavaScript file (`file_type == "js"`), request the
  downloadable file and save it locally as `<sha256>.js`.

Requirements
------------
- Python 3.8+
- pip packages: `requests`, `python-dotenv`
- A `.env` file in this folder (or the project root) with the variable:
  - `AUTH_KEY` â€” your MalwareBazaar API key

Usage
-----
1. Create a `.env` file with `AUTH_KEY=your_api_key`. (See sample.env)
2. Place `VT_miners.csv` in this directory (the script expects the file name exactly).
3. Run the downloader:

```sh
python3 sok_downloader.py
```

Notes and caveats
-----------------
- The script uses POST queries to `https://mb-api.abuse.ch/api/v1/` and checks
  the `query_status` returned by the API. If the status indicates an error or
  the file is missing, the hash is skipped.
- The script saves files with the `.js` extension and makes no attempt to
  validate or sanitize file contents beyond the API classification.
- Be mindful of API rate limits. The script uses a ThreadPoolExecutor to perform
  checks/downloads in parallel; adjust `max_workers` or add delays if you hit
  rate limiting.
- This tool downloads potentially malicious JavaScript. Use a controlled,
  isolated environment and follow your organization's malware handling policies.

